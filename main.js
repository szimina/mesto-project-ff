(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{OP:()=>h,YX:()=>v,q_:()=>y,xZ:()=>q,Gs:()=>S,AQ:()=>E,Ml:()=>G});var t={headers:{authorization:"c8fa0ce8-1016-42e6-8f5d-cacf41e63af7","Content-Type":"application/json"}};function r(){var e=S.querySelector('input[name="name"]'),r=S.querySelector('input[name="description"]');return fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me",{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e.value,about:r.value})})}function n(){var e=q.querySelector('input[name="place-name"]'),r=q.querySelector('input[name="link"]');return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards",{method:"POST",headers:t.headers,body:JSON.stringify({name:e.value,link:r.value})})}function o(){var e=E.querySelector('input[name="link"]');return fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me/avatar",{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e.value})})}function c(e,t,r,n){var o=h.querySelector(".card").cloneNode(!0),c=o.querySelector(".card__title"),a=o.querySelector(".card__image"),i=o.querySelector(".card__delete-button"),u=o.querySelector(".card__like-button"),s=o.querySelector(".card__image"),l=o.querySelector(".card__like-count");return c.textContent=e.name,a.src=e.link,a.id=e._id,a.alt=e.name,l.textContent=e.likes.length,e.likes.some((function(e){return e._id===v}))&&u.classList.add("card__like-button_is-active"),e.owner._id===v&&i.classList.remove("card__delete-button-hidden"),i.addEventListener("click",t),u.addEventListener("click",r),s.addEventListener("click",n),o}function a(e){var r=e.target.closest(".places__item");r.remove();var n=r.querySelector(".card__image").id;console.log(n),fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/".concat(n),{method:"DELETE",headers:t.headers})}function i(e){if(e.target.classList.contains("card__like-button")){e.target.classList.toggle("card__like-button_is-active");var r=e.target.closest(".places__item").querySelector(".card__image").id;e.target.classList.contains("card__like-button_is-active")?(n=r,fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(n),{method:"PUT",headers:t.headers}).then((function(e){return e.json()})).then((function(e){document.getElementById(n).parentElement.querySelector(".card__like-count").textContent=e.likes.length}))):function(e){fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.json()})).then((function(t){document.getElementById(e).parentElement.querySelector(".card__like-count").textContent=t.likes.length}))}(r)}var n}function u(e){e.classList.add("popup_is-opened"),e.classList.add("popup_is-animated"),document.addEventListener("keydown",l)}function s(e){e.classList.remove("popup_is-opened"),e.classList.remove("popup_is-animated"),document.removeEventListener("keydown",l)}function l(e){"Escape"===e.key&&s(document.querySelector(".popup_is-opened"))}function d(e){var t=e.currentTarget;e.target===t&&s(t)}function p(e,t,r,n){var o=e.querySelector(".".concat(t.name,"-error"));t.classList.remove(r),o.classList.remove(n),o.textContent=""}function _(e,t,r,n){var o=e.querySelector(t);Array.from(e.querySelectorAll(r)).some((function(e){return!e.validity.valid}))?(o.disabled=!0,o.classList.add(n)):(o.disabled=!1,o.classList.remove(n))}function f(e,t){var r=e.querySelectorAll(t.inputSelector),n=e.querySelector(t.submitButtonSelector);r.forEach((function(r){console.log(r),p(e,r,t.inputErrorClass,t.errorClass),r.setCustomValidity("")})),n.disabled=!1,n.classList.remove(t.inactiveButtonClass)}function m(e,t){e.addEventListener("submit",(function(e){e.preventDefault()})),_(e,t.submitButtonSelector,t.inputSelector,t.inactiveButtonClass),e.querySelectorAll(t.inputSelector).forEach((function(r){r.addEventListener("input",(function(){!function(e,t,r,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?p(e,t,r,n):function(e,t,r,n,o){var c=e.querySelector(".".concat(t.name,"-error"));t.classList.add(n),c.textContent=r,c.classList.add(o)}(e,t,t.validationMessage,r,n)}(e,r,t.inputErrorClass,t.errorClass),_(e,t.submitButtonSelector,t.inputSelector,t.inactiveButtonClass)}))}))}fetch("https://nomoreparties.co/v1/wff-cohort-2/cards",{headers:t.headers}).then((function(e){return e.json().then((function(e){e.forEach((function(e){var t,r,n,o;t=e,r=a,n=i,o=G,y.append(c(t,r,n,o))}))})).catch((function(e){console.log(e)}))})),fetch("https://nomoreparties.co/v1/wff-cohort-2/users/me",{headers:t.headers}).then((function(e){return e.json()})).then((function(e){return document.querySelector(".profile__title").textContent=e.name,document.querySelector(".profile__description").textContent=e.about,document.querySelector(".profile__image").style='background-image: url("'.concat(e.avatar,'")'),e})).catch((function(e){console.log("Ошибка. Запрос не выполнен")}));var v="f3ed47b5ee44c8f551fa03d7",y=document.querySelector(".places__list"),h=document.querySelector("#card-template").content,S=document.querySelector(".popup_type_edit"),q=document.querySelector(".popup_type_new-card"),b=document.querySelector(".popup_type_image"),E=document.querySelector(".popup_type_new-avatar"),g=document.querySelector(".profile__edit-button"),k=document.querySelector(".profile__add-button"),L=document.querySelector(".profile__image__edit"),C=S.querySelector(".popup__close"),w=q.querySelector(".popup__close"),x=b.querySelector(".popup__close"),B=E.querySelector(".popup__close"),O=S.querySelector(".popup__button"),T=q.querySelector(".popup__button"),j=E.querySelector(".popup__button"),A=[S,q,b,E],P=[C,w,x,B],D=document.querySelector(".profile__title"),M=document.querySelector(".profile__description"),N=S.querySelector('input[name="name"]'),J=S.querySelector('input[name="description"]'),V=q.querySelector('form[name="new-place"]'),H=q.querySelector('input[name="place-name"]'),I=q.querySelector('input[name="link"]'),z={formSelector:".popup_is-opened",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function G(e){var t=e.target.src,r=e.target.alt;u(b);var n=b.querySelector(".popup__image");b.querySelector(".popup__caption").textContent=r,n.src=t,n.alt=r}g.addEventListener("click",(function(){u(S),N.value=D.textContent,J.value=M.textContent,m(S,z),O.addEventListener("click",r)})),k.addEventListener("click",(function(){u(q),m(q,z),T.addEventListener("click",n)})),L.addEventListener("click",(function(){u(E),m(E,z),j.addEventListener("click",o)})),P.forEach((function(e){e.addEventListener("click",(function(){s(e.closest(".popup"))}))})),A.forEach((function(e){e.addEventListener("click",d)})),S.addEventListener("submit",(function(e){e.preventDefault(),D.textContent=N.value,M.textContent=J.value,s(S),f(S,z)})),q.addEventListener("submit",(function(e){var t,r,n,o;e.preventDefault(),t={name:H.value,link:I.value,likes:[],owner:{_id:"f3ed47b5ee44c8f551fa03d7"}},r=a,n=i,o=G,y.prepend(c(t,r,n,o)),s(q),V.reset(),f(q,z)})),E.addEventListener("submit",(function(e){e.preventDefault(),s(E),f(E,z)}))})();